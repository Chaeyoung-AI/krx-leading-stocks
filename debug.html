<!DOCTYPE html>
<html><head><meta charset="UTF-8"><title>Debug</title></head>
<body>
<pre id="out">testing...</pre>
<script type="module">
const out = document.getElementById('out');
try {
  const base = window.location.origin + window.location.pathname.replace(/\/[^/]*$/, '');
  out.textContent = 'baseUrl: ' + base + '\n';

  const indexUrl = base + '/data/index.json';
  out.textContent += 'fetching: ' + indexUrl + '\n';

  const res = await fetch(indexUrl);
  out.textContent += 'status: ' + res.status + '\n';

  const data = await res.json();
  out.textContent += 'dates: ' + JSON.stringify(data.dates) + '\n';

  if (data.dates.length > 0) {
    const dailyUrl = base + '/data/daily/' + data.dates[0] + '.json';
    out.textContent += 'fetching daily: ' + dailyUrl + '\n';
    const res2 = await fetch(dailyUrl);
    out.textContent += 'daily status: ' + res2.status + '\n';
    const d2 = await res2.json();
    out.textContent += 'kospi count: ' + (d2.kospi ? d2.kospi.length : 0) + '\n';
    out.textContent += 'first: ' + JSON.stringify(d2.kospi[0]) + '\n';
  }
} catch(e) {
  out.textContent += 'ERROR: ' + e.message + '\n' + e.stack;
}
</script>
</body>
</html>
